<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mini Multiplayer</title>
  <style>
    canvas { border: 1px solid black; background: #f0f0f0; }
  </style>
</head>
<body>
  <canvas id="game" width="400" height="400"></canvas>
  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    let myId = null;
    let positions = {};
    const socket = new WebSocket("wss://typical-numerous-menu.glitch.me");

    socket.onmessage = (event) => {
      const data = JSON.parse(event.data);
      if (data.type === "init") {
        myId = data.id;
      }
      if (data.type === "positions") {
        positions = data.positions;
      }
    };

    let x = 200, y = 200;

    function draw() {
      ctx.clearRect(0, 0, 400, 400);
      for (let id in positions) {
        ctx.fillStyle = (id === myId) ? "blue" : "red";
        ctx.beginPath();
        ctx.arc(positions[id].x, positions[id].y, 10, 0, 2 * Math.PI);
        ctx.fill();
      }
    }

    function update() {
      if (myId) {
        socket.send(JSON.stringify({ type: "move", x, y }));
      }
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowUp") y -= 5;
      if (e.key === "ArrowDown") y += 5;
      if (e.key === "ArrowLeft") x -= 5;
      if (e.key === "ArrowRight") x += 5;
      update();
    });

    setInterval(draw, 30);
  </script>
</body>
</html>
